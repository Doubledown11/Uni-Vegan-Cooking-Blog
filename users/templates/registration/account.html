<!DOCTYPE html>
<html lang="en" id="html_account">


    <head>
        {% load static %}

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Vegan Cooking Blog</title>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-0m3uEEopG4MuXfV0JyXeCcfy8p6t1P26xfn8d1OPF9aOxw++viJ8zA/yzm0lPaBP8RD2H1bMpnfPZn8r3+m0BQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="{% static 'bootstrap.js' %}"></script>
        
        <script src="{% static '/js/Dark_Mode_Toggle.js' %}"></script>
        <script src="{% static '/js/Sign_Out_Modal_Account.js' %}"></script>
        <script src="{% static '/js/change_account_info_modal.js' %}"></script>
        <script src="{% static '/js/upload_profile_pic.js' %}"></script>
        
        
        <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


        <style>

            

            /* Account Information Change Modal Form Content Below */ 
            #account_modal_content {
                background-color: #fefefe;
                margin: 15% auto; /* 15% from the top and centered */
                padding: 20px;
                border: 1px solid #888;
                width: 80%; /* Could be more or less, depending on screen size */
                height: 585px;
                border-radius: 10px 10px 10px 10px;
                position: relative;
                top: -200px;
                z-index: 0;
            }

            
            /* Styling for the Account Info Change modal Box */
            #account_info_change_modal {
                display: none; /* Hidden by default */
                position: fixed; /* Stay in place */
                z-index: 20; /* Sit on top */
                left: 0;
                top: 0;
                width: 100%; /* Full width */
                height: 100%; /* Full height */
                overflow: auto; /* Enable scroll if needed */
                background-color: rgb(0,0,0); /* Fallback color */
                background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
                padding-top: 200px;
            }


            #change_account_modal_open {
                display: block;
            }


            #close_account_change_modal {
                color: #aaa;
                float: right;
                font-size: 28px;
                font-weight: bold;
                height: 1%;
                width: 1%;
            }


            #close_account_change_modal:hover,#close_account_change_modal:focus {
                color: black;
                text-decoration: none;
                cursor: pointer;
            }


            #modal_text_cancel_account {
                font-size: x-large;
            }


            #confirm_change_button {
                height: 50px;
                width: 200px;
                border-radius: 10px 10px 10px 10px;
                font-size: medium;
                background-color: rgb(248, 210, 95);
                color: #000;
                border: 0px;
                position: relative;
                top: 90px;
                right: 120px;
            }


            #confirm_change:hover {
                background-color: rgb(248, 210, 95);
                color: #000;
            
            }


            #confirm_change:active {
                border: 0px;
                outline: none;
                box-shadow: none; 
            }

            /* Above is the styling for the account change modal */



        </style>

        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    </head>



    <body>
        <div class="header">
            <center>The Vegan Meals Which Got Me Through University</center>
            <div class="top_line_account" id="top_line_account"></div>

                <div class="header_buttons_account" id="header_buttons_account">
                    <center><a href = "{% url 'blog:blog_index' %}" class="btn btn-secondary" id="header_button_account">Home</a></center>
                    <center><a href = "{% url 'blog:blog_index' %}" class="btn btn-secondary" id="header_button_account">Recipes</a></center>
                    <center><a href = "{% url 'blog:contact' %}" class="btn btn-secondary" id="header_button_account">Contact</a></center>
                    <center><a href = "{% url 'blog:blog_index' %}" class="btn btn-secondary" id="header_button_account">About</a></center>
                    

                    <button class="btn btn-secondary" id="header_button_modal_account">Sign-Out</button>
                   
                    
                    <!-- Below is the code for the logout modal -->
                    <div id="logout_modal_account" class="modal">
                        <div class="logout_modal_content_account" id="logout_modal_content_account">
                            <span id="close_signout_modal_account" class="close">&times;</span>
                            <center><p id="modal_text_cancel_signout">Are you sure you want to sign out?</p></center>
                            <center>
                                <form method='post' id="signout_form" action="{% url 'users:logout_user' %}">
                                    {% csrf_token %}
                                    
                                    <button class="btn-secondary" id="confirm_signout_account" >Sign-Out</button>
                                </form>                             
                            </center> 
                        </div>
                    </div>  


                    
                    <form method="post" id="header_form_account">
                        {% csrf_token %}
                        {{ SearchForm }}
                        <input type="text" id="header_form_account_input" placeholder="Enter Text Here...">
                        
                        <button type="submit" id="submit_button_header_account">Search</button>
                    </form>
                </div>


            <div class="top_line_account2" id="top_line_account2"></div>
        </div>




        <div class="container" id="my_account_container">    
            <h1 id="my_account_header">My Account:</h1>
            <!--
                Have account information displayed to the page in tags.
                If user wants to change something, have them click the change info button 
                which opens a modal with a form on it which allows them to change their information
            -->

            {% if not user.is_superuser %}
            
            <!-- TODO NON ADMIN USERS ACCOUNT SECTION -- Change from below add change password -->
            <div class="container" id="account_information_container">
                <h2 id="account_information_header">Account Information:</h2>
                   
                
                    <h3 id="account_first_name">First Name:</h3>
                    {% if user.first_name %}
                        <span id="account_first_name_span_nonsuper">{{ user.first_name }}</span>
                    {% else %}
                        <span id="account_first_name_span_nonsuper">No First Name Information Given Yet</span>
                    {% endif %}
                    
                    <h3 id="account_last_name">Last Name:</h3>
                    {% if user.last_name %}
                        <span id="account_last_name_span_nonsuper">{{ user.last_name }}</span>
                    {% else %}
                        <span id="account_last_name_span_nonsuper">No Last Name Information Given Yet</span>
                    {% endif %}

                    <h3 id="account_email">Email:</h3>
                    {% if user.email %}
                       <span id="account_email_span_nonsuper">{{ user.email }}</span>
                    {% else %}
                        <span id="account_email_span_nonsuper">No Email Information Given yet</span>
                    {% endif %}

                    <h3 id="account_username">Username:</h3>
                    <span id="account_username_span_nonsuper">{{ user }}</span>


                    <div class="line1" id="line1_account"></div>


                    <!-- Have password obscured by wildcards * 
                        Ask for current password prior to being able to change  
                    -->
                    <h3 id="account_password_change">Click to change your password</h3>
                    <form method="link" action="change_password_page/" id='account_password_change_form'>
                        <button class="btn btn-secondary" id="account_password_change_button" >Change Password</button>
                    </form>


                    <!-- Address info? -->

                <h2 id="change_information_header">Something wrong? Click to change account information</h2>

                <button class="btn btn-secondary" id="account_info_change_button">Change Account Information</button>


                <div id="account_info_change_modal" class="account_change_modal">
                    <div class="account_modal-content" id="account_modal_content">
                        <span id="close_account_change_modal" class="close">&times;</span>
                        <center><p id="modal_text_cancel_account">Are you sure you want to cancel?</p></center>

                        <center>
                            <form method='post' id="account_info_change_form" action="{% url 'users:account_info_change' %}">
                                {% csrf_token %}
                                
                                <h4 id="username_modal">Old Username:</h4>
                                <input type="text" id="username_modal_input" placeholder="REQUIRED" name="old_username">

                                <h4 id="change_username_modal">Change Username:</h4>
                                <input type="text" id="change_username_modal_input" placeholder="Enter New Username">

                                <!-- Will need to send confirmation email to both new and old emails -->
                                <h4 id="change_email_modal">Change Email:</h4>
                                <input type="text" id="change_email_modal_input" placeholder="Enter New Email">

                                <h4 id="change_first_name_modal">Change First Name:</h4>
                                <input type="text" id="change_first_name_modal_input" placeholder="Enter First Name">

                                <h4 id="change_last_name_modal">Change Last Name:</h4>
                                <input type="text" id="change_last_name_modal_input" placeholder="Enter Last Name">


                                <button class="btn-secondary" id="confirm_change_button">Confirm Changes</button>
                            </form>                             
                        </center> 
                    </div>
                </div> 
            </div>
            {% else %}


            <div class="container" id="account_information_container">
                <h2 id="account_information_header">Account Information:</h2>
                   
                
                    <h3 id="account_first_name">First Name:</h3>
                    {% if user.first_name %}
                        <span id="account_first_name_span">{{ user.first_name }}</span>
                    {% else %}
                        <span id="account_first_name_span">No First Name Information Given Yet</span>
                    {% endif %}
                    
                    <h3 id="account_last_name">Last Name:</h3>
                    {% if user.last_name %}
                        <span id="account_last_name_span">{{ user.last_name }}</span>
                    {% else %}
                        <span id="account_last_name_span">No Last Name Information Given Yet</span>
                    {% endif %}

                    <h3 id="account_email">Email:</h3>
                    <span id="account_email_span">{{ user.email }}</span>


                    <h3 id="account_username">Username:</h3>
                    <span id="account_username_span">{{ user.username }}</span>

                    <div class="line1" id="line1_account"></div>
                    
                    <!-- Have password obscured by wildcards * 
                        Ask for current password prior to being able to change  
                    -->
                    <h3 id="account_password_change">Click to change your password</h3>
                    <form method="link" action="change_password_page/" id='account_password_change_form'>
                        <button class="btn btn-secondary" id="account_password_change_button" >Change Password</button>
                    </form>


                    <!--
                    
                    Address info? 
                    
                     -->



                <h2 id="change_information_header">Something wrong? Click to change account information</h2>

                <button class="btn btn-secondary" id="account_info_change_button">Change Account Information</button>


                <div id="account_info_change_modal" class="account_change_modal">
                    <div class="account_modal-content" id="account_modal_content">
                        <span id="close_account_change_modal" class="close">&times;</span>
                        <center><p id="modal_text_cancel_account">Are you sure you want to cancel?</p></center>

                        <center>
                            <form method='post' id="account_info_change_form" action="account_info_change/">
                                {% csrf_token %}
                                
                                <h4 id="username_modal">Old Username:</h4>
                                <input type="text" id="username_modal_input" placeholder="REQUIRED" name="old_username">

                                <h4 id="change_username_modal">Change Username:</h4>
                                <input type="text" id="change_username_modal_input" placeholder="Enter New Username" name="username">

                                <!-- Will need to send confirmation email to both new and old emails -->
                                <h4 id="change_email_modal">Change Email:</h4>
                                <input type="text" id="change_email_modal_input" placeholder="Enter New Email" name="email">

                                <h4 id="change_first_name_modal">Change First Name:</h4>
                                <input type="text" id="change_first_name_modal_input" placeholder="Enter First Name" name="first_name">

                                <h4 id="change_last_name_modal">Change Last Name:</h4>
                                <input type="text" id="change_last_name_modal_input" placeholder="Enter Last Name" name="last_name">

                                <button class="btn-secondary" id="confirm_change_button" >Confirm Changes</button>
                            </form>                             
                        </center> 
                    </div>
                </div> 
            </div>

            {% endif %}
        
            <div class="container" id="profile_picture_container">
                <h2 id="profile_picture_header">Profile Picture?</h2>
                
                <div class="line_little" id="line_little"></div>
    
                <!-- 
                Need to check if a picture has been uploaded i think with tags 
                    { if photo uploaded %}
    
                if no photo uploaded display the generic profile picture saved in static/img/
                -->
                
    
                <form id="change_profile_pic_form" method="post" action="account/account/change_profile_pic/">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <!-- USE DJANGO TAGS WITH IF PROFILE.PROFILE_PIC TO CHECK IF THE CURRENT USER HAS A PROFILE PIC
                    AND IF THEY DO SHOW IT, ELSE SHOW THE BLANK PIC -->
                    
                    {% if form.profile_picture %}    
                        <div class="container" id="profile_pic_div">
                            <img src="{{ form.profile_picture.url }}" id="profile_pic_uploaded" alt="Profile Picture">
                        </div>
    
                    {% else %} 
    
                        <div class="container" id="profile_pic_div">
                            <img src="/media/media/profile_pics/blank_profile_pic.jpg " id="profile_pic_uploaded" alt="Profile Picture">
                        </div> 
                    {% endif %}
    
                    
                    <!-- input cleanse file types later -->
                    <div class="mb-3">
                        <input class="form-control form-control-sm" accept="image/*" id="photo_upload_input" type="file" name="photo_upload" 
                            style="
                                position: relative;
                                top: 40px;
                                left: -10px;
                                height: 85%;
                                width: 100%;
                                padding-bottom: 0%;
                                ">
                    </div>
    
                    <!-- REMOVE CSS FOR BELOW!!!!!!!!!!!!!!!!!!!!!
                    <button type="submit" id="photo_upload_button">
                        <span id="photo_button_span">Upload Picture Above</span>
                    </button> -->
                </form>
                

    
            </div>
            <div class="container" style="height: 50px;"></div>
            <div class="container" style="height: 50px;"></div>
        </div>        


        <!-- Ensures only site admins can see enquiries made to the application-->
        {% if user.is_superuser %}
        <div class="container" id="contact_enquiry_container">
            <h1 id="enquiry_title">Contact Messages Left through the sites Contact Form</h1>
            
            <div class="container" id="enquiry_container_2">
                
                {% for enquiry in enquiries %}
                <div class="container" id="enquiry_container_3">
                    <div class="container" id="submitted_on_container">
                        <h3><a href="{% url 'users:enquiries' %}" id="enquiry_url" class="Enquiry_URL">Submitted On:</a></h3>
                    </div>

                    <div class="container" id="submitted_on_date_container">    
                        <h3><a href="{% url 'users:enquiries' %}" id="enquiry_url2" class="Enquiry_URL2">{{enquiry.created_on}}</a></h3> 
                    </div>
                     
                    <div class="container" id="submitted_by_container">
                        <small id="submitted_by"> Submitted By:</small> 
                    </div>
                    
                    <div class="container" id="submitted_by_name_title_container">
                        <small id="submitted_by3">First / Last Name:</small>
                    </div>
                    
                    <div class="container" id="submitted_by_names_container">
                        <small id="submitted_by2">{{ enquiry.fname }}  {{ enquiry.lname }}</small>       
                    </div>

                    <div class="container" id="email_container">
                        <small id="email_space">Email Address:</small>
                    </div>

                    <div class="container" id="email_in_container">
                        <small id="enquiry_email">{{enquiry.email}}</small>
                    </div>

                    <div class="container" id="select_title_container">
                        Enquiry Type
                    </div>

                    <div class="container" id="select_container">
                        <small id="enquiry_select_account">{{ enquiry.select }}</small>
                    </div>

                    <div class="container" id="message_title_container">
                        Enquiry Message:
                    </div>

                    <div class="container" id="message_container">
                        {{enquiry.message}}
                    </div>

                    <div class="line3" id="line3"></div>

                </div>
                {% endfor %}
                
            </div>



        </div>
        {% endif %}



    </body>



    <footer style="height: 100px;">

    </footer>


</html>